========================================
MANAGER LOGIN DEBUG GUIDE
========================================

Váº¤N Äá»€ HIá»†N Táº I:
- Server log cho tháº¥y manager login THÃ€NH CÃ”NG
- NhÆ°ng Android app bÃ¡o lá»—i khÃ´ng thá»ƒ Ä‘Äƒng nháº­p
- CÃ³ thá»ƒ lÃ  váº¥n Ä‘á» client-side

========================================
DEBUG STEPS
========================================

1. KIá»‚M TRA SERVER (HOÃ€N THÃ€NH):
   âœ… Manager user tá»“n táº¡i: manager/123456/MANAGER
   âœ… Password validation Ä‘Ã£ sá»­a: user.password.equals(loginData.password)
   âœ… Server log: "âœ… LOGIN SUCCESS: manager (MANAGER)"

2. KIá»‚M TRA ANDROID CLIENT:

A. KIá»‚M TRA LOGIN REQUEST FORMAT:
```java
// Äáº£m báº£o format Ä‘Ãºng
JSONObject loginData = new JSONObject();
loginData.put("username", "manager");        // CHÃNH XÃC
loginData.put("password", "123456");         // CHÃNH XÃC  
loginData.put("role", "MANAGER");            // CHÃNH XÃC (viáº¿t hoa)

socket.emit("login", loginData);
```

B. KIá»‚M TRA RESPONSE HANDLER:
```java
socket.on("login_response", args -> {
    try {
        JSONObject response = (JSONObject) args[0];
        
        // DEBUG: Log toÃ n bá»™ response
        Log.d("LoginDebug", "Full response: " + response.toString());
        
        boolean success = response.getBoolean("success");
        Log.d("LoginDebug", "Success: " + success);
        
        if (success) {
            String username = response.getString("username");
            String role = response.getString("role");
            String token = response.getString("token");
            String message = response.getString("message");
            
            Log.d("LoginDebug", "Username: " + username);
            Log.d("LoginDebug", "Role: " + role);
            Log.d("LoginDebug", "Token: " + token);
            Log.d("LoginDebug", "Message: " + message);
            
            // Xá»¬ LÃ THÃ€NH CÃ”NG
            runOnUiThread(() -> {
                // Update UI
                Toast.makeText(this, "Manager login successful!", Toast.LENGTH_SHORT).show();
            });
            
        } else {
            String error = response.optString("error", "Unknown error");
            Log.e("LoginDebug", "Login failed: " + error);
            
            runOnUiThread(() -> {
                Toast.makeText(this, "Login failed: " + error, Toast.LENGTH_SHORT).show();
            });
        }
        
    } catch (JSONException e) {
        Log.e("LoginDebug", "JSON parsing error: " + e.getMessage());
    }
});
```

C. KIá»‚M TRA CONNECTION STABILITY:
```java
socket.on(Socket.EVENT_CONNECT, args -> {
    Log.d("Socket", "âœ… Connected - ID: " + socket.id());
});

socket.on(Socket.EVENT_DISCONNECT, args -> {
    Log.w("Socket", "âŒ Disconnected: " + args[0]);
});

socket.on(Socket.EVENT_CONNECT_ERROR, args -> {
    Log.e("Socket", "ðŸš« Connection error: " + args[0]);
});
```

========================================
TEST CASES
========================================

1. TEST Vá»šI BROWSER:
   - Má»Ÿ file: test-manager-login.html
   - Click "Test Manager Login"
   - Kiá»ƒm tra cÃ³ nháº­n Ä‘Æ°á»£c response khÃ´ng

2. TEST Vá»šI ANDROID:
   - ThÃªm debug logs nhÆ° trÃªn
   - Login vá»›i manager/123456
   - Kiá»ƒm tra logcat output

========================================
EXPECTED SERVER LOG
========================================

Khi manager login thÃ nh cÃ´ng:
```
ðŸ”‘ LOGIN ATTEMPT:
   Username: manager
   Password: 123456
   Role: MANAGER
   Found user: manager/123456/MANAGER
âœ… LOGIN SUCCESS: manager (MANAGER)
```

========================================
EXPECTED ANDROID LOG
========================================

Khi nháº­n response thÃ nh cÃ´ng:
```
D/LoginDebug: Full response: {"success":true,"username":"manager","role":"MANAGER","token":"token_manager_1234567890","message":"Login successful"}
D/LoginDebug: Success: true
D/LoginDebug: Username: manager
D/LoginDebug: Role: MANAGER
D/LoginDebug: Token: token_manager_1234567890
D/LoginDebug: Message: Login successful
```

========================================
COMMON ISSUES
========================================

1. CASE SENSITIVITY:
   - Username: "manager" (lowercase)
   - Role: "MANAGER" (uppercase)

2. JSON PARSING:
   - Äáº£m báº£o cast (JSONObject) args[0] Ä‘Ãºng
   - Kiá»ƒm tra key names chÃ­nh xÃ¡c

3. UI THREAD:
   - Pháº£i dÃ¹ng runOnUiThread() cho UI updates
   - Socket events cháº¡y trÃªn background thread

4. CONNECTION TIMING:
   - Äáº£m báº£o socket.connected() = true trÆ°á»›c khi emit
   - ThÃªm timeout cho login request

========================================
QUICK FIX CODE
========================================

```java
public void loginAsManager() {
    if (!socket.connected()) {
        Log.e("Login", "Socket not connected!");
        return;
    }
    
    try {
        JSONObject loginData = new JSONObject();
        loginData.put("username", "manager");
        loginData.put("password", "123456");
        loginData.put("role", "MANAGER");
        
        Log.d("Login", "Sending manager login: " + loginData.toString());
        socket.emit("login", loginData);
        
        // Timeout handler
        Handler handler = new Handler();
        handler.postDelayed(() -> {
            Log.w("Login", "Login timeout - no response received");
        }, 10000); // 10 second timeout
        
    } catch (JSONException e) {
        Log.e("Login", "JSON creation error: " + e.getMessage());
    }
}
```

========================================